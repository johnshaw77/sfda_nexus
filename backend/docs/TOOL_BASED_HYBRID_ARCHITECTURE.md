# åŸºæ–¼ Tool çš„æ··åˆæ¶æ§‹å¯¦æ–½ç¸½çµ

2025-06-27 10:00

## ğŸ¯ å¯¦æ–½èƒŒæ™¯

ç”¨æˆ¶æå‡º AI æŒ‡å°æ‡‰è©²å¯«åœ¨å…·é«”çš„ tool æ–‡ä»¶ï¼ˆå¦‚ `get-mil-list.js`ï¼‰ä¸­ï¼Œè€Œä¸æ˜¯é›†ä¸­åœ¨ä¸€å€‹é…ç½®æ–‡ä»¶è£¡ï¼Œé¿å…å–®ä¸€æ–‡ä»¶æ‰¿æ“”éå¤šè²¬ä»»ã€‚ç¶“éé‡æ–°è¨­è¨ˆï¼Œæˆ‘å€‘å¯¦æ–½äº†**åŸºæ–¼ Tool çš„æ··åˆæ¶æ§‹**ã€‚

## ğŸ—ï¸ æ­£ç¢ºçš„æ¶æ§‹è¨­è¨ˆ

### ğŸ“ **Tool å±¤**ï¼ˆä¾‹å¦‚ `get-mil-list.js`ï¼‰

**ä½ç½®**: `sfda_mcpserver/mcp-server/src/tools/mil/get-mil-list.js`

**è·è²¬**:

- ğŸ¯ ç®¡ç†è©²å·¥å…·çš„åŸºç¤æŒ‡å°ï¼ˆæ ¸å¿ƒåŸå‰‡ã€å¿…è¦æ¬„ä½ã€æ ¼å¼åŒ–è¦æ±‚ï¼‰
- ğŸ“‹ å°±è¿‘ç®¡ç†ï¼šå·¥å…·çš„æŒ‡å°å°±åœ¨å·¥å…·æ–‡ä»¶ä¸­
- ğŸ”§ ç¨ç«‹æ€§ï¼šæ¯å€‹å·¥å…·ç®¡ç†è‡ªå·±çš„è¦å‰‡

**å¯¦æ–½æ–¹å¼**:

```javascript
export class GetMILListTool extends BaseTool {
  getBaseInstructions() {
    const instructions = [];

    // ğŸ¯ æ ¸å¿ƒåŸå‰‡
    instructions.push("ğŸ¯ **åŸºç¤æŒ‡å°åŸå‰‡**ï¼š");
    instructions.push("- **é‡è¦ï¼šåªèƒ½åŸºæ–¼çµ±è¨ˆæ‘˜è¦é€²è¡Œåˆ†æï¼Œä¸èƒ½ç·¨é€ å…·é«”å°ˆæ¡ˆ**");
    // ... å…¶ä»–åŸºç¤æŒ‡å°

    return instructions.join("\n");
  }
}
```

### ğŸ“ **Service å±¤**ï¼ˆä¾‹å¦‚ `mil-service.js`ï¼‰

**ä½ç½®**: `sfda_mcpserver/mcp-server/src/services/mil/mil-service.js`

**è·è²¬**:

- ğŸ§  å°ˆæ³¨æ–¼å‹•æ…‹æŒ‡å°ç”Ÿæˆ
- ğŸ“Š åŸºæ–¼æ•¸æ“šç”Ÿæˆæ¢ä»¶åŒ–åˆ†æé‡é»
- âš¡ è¼•é‡åŒ–ï¼šä¸å†æ‰¿æ“”åŸºç¤æŒ‡å°è²¬ä»»

**å¯¦æ–½æ–¹å¼**:

```javascript
// å¾ Tool ç²å–åŸºç¤æŒ‡å°
const milTool = new GetMILListTool();
const baseInstructions = milTool.getBaseInstructions();

// ç”Ÿæˆå‹•æ…‹æŒ‡å°
const dynamicInstructions = generateDynamicInstructions(stats, filters, data);

// åˆä½µæŒ‡å°
const aiInstructions = dynamicInstructions
  ? `${baseInstructions}ğŸ§  **å‹•æ…‹åˆ†ææŒ‡å°**ï¼š\n${dynamicInstructions}`
  : baseInstructions;
```

## ğŸ“Š æ¶æ§‹å„ªå‹¢å¯¦ç¾

### âœ… **å°±è¿‘ç®¡ç†**

- æ¯å€‹ Tool æ–‡ä»¶ç®¡ç†è‡ªå·±çš„åŸºç¤æŒ‡å°
- ç›¸é—œé‚è¼¯é›†ä¸­åœ¨ä¸€å€‹åœ°æ–¹ï¼Œæ˜“æ–¼ç†è§£å’Œç¶­è­·
- é–‹ç™¼è€…å¯ä»¥åœ¨å·¥å…·æ–‡ä»¶ä¸­ç›´æ¥çœ‹åˆ°å’Œä¿®æ”¹æŒ‡å°è¦å‰‡

### âœ… **è·è²¬æ¸…æ™°**

- **Tool å±¤**: å·¥å…·ç‰¹å®šçš„åŸºç¤è¦å‰‡
- **Service å±¤**: æ¥­å‹™é‚è¼¯å’Œå‹•æ…‹æŒ‡å°
- **é¿å…å–®é»éè¼‰**: ä¸æœƒè®“å–®ä¸€æ–‡ä»¶æ‰¿æ“”éå¤šè²¬ä»»

### âœ… **ç¨ç«‹æ€§å¼·**

- æ¯å€‹å·¥å…·çš„æŒ‡å°å®Œå…¨ç¨ç«‹
- ä¿®æ”¹ä¸€å€‹å·¥å…·çš„æŒ‡å°ä¸å½±éŸ¿å…¶ä»–å·¥å…·
- æ˜“æ–¼æ–°å¢å·¥å…·å’Œæ“´å±•åŠŸèƒ½

### âœ… **æ•¸æ“šé©…å‹•**

- Service å±¤ä»å¯åŸºæ–¼å¯¦éš›æ•¸æ“šç”Ÿæˆå‹•æ…‹æŒ‡å°
- ä¿ç•™æ™ºèƒ½åˆ†æçš„æ ¸å¿ƒå„ªå‹¢

## ğŸ§ª æ¸¬è©¦çµæœ (100% é€šé)

```
ğŸ‰ åŸºæ–¼ Tool çš„æ··åˆæ¶æ§‹æ¸¬è©¦ç¸½çµ
============================================================
âœ… åŸºæ–¼ Tool çš„æ··åˆæ¶æ§‹è¨­è¨ˆå®Œç¾ï¼
âœ… Tool å±¤åŸºç¤æŒ‡å°åŠŸèƒ½æ­£å¸¸
âœ… Service å±¤å‹•æ…‹æŒ‡å°åˆä½µæ­£ç¢º
âœ… æ‰€æœ‰å¿…è¦æ¬„ä½å®Œæ•´åŒ…å« (15/15)
âœ… è·è²¬åˆ†é›¢æ¸…æ™°ï¼Œé¿å…å–®é»éè¼‰
âœ… å°±è¿‘ç®¡ç†åŸå‰‡å¾—åˆ°å®Œç¾é«”ç¾
```

## âš–ï¸ æ¶æ§‹æ¯”è¼ƒ

### ğŸ†š **vs å…¨éƒ¨æ”¾åœ¨ Service**

- âœ… æ›´å¥½ï¼šé¿å…åŸºç¤è¦å‰‡é‡è¤‡å®šç¾©
- âœ… æ›´å¥½ï¼šTool çš„æŒ‡å°å°±åœ¨ Tool é™„è¿‘

### ğŸ†š **vs å…¨éƒ¨æ”¾åœ¨ ai-instructions.js**

- âœ… æ›´å¥½ï¼šé¿å…å–®ä¸€æ–‡ä»¶éåº¦è‚¥å¤§
- âœ… æ›´å¥½ï¼šæ¯å€‹å·¥å…·ç®¡ç†è‡ªå·±çš„è¦å‰‡
- âœ… æ›´å¥½ï¼šé™ä½è€¦åˆåº¦ï¼Œæé«˜ç¨ç«‹æ€§

## ğŸ› ï¸ æ–°å¢å·¥å…·æŒ‡å—

### 1. åœ¨ Tool æ–‡ä»¶ä¸­æ·»åŠ åŸºç¤æŒ‡å°æ–¹æ³•

```javascript
export class NewToolName extends BaseTool {
  getBaseInstructions() {
    const instructions = [];

    // æ ¹æ“šå·¥å…·ç‰¹æ€§å®šç¾©æ ¸å¿ƒåŸå‰‡
    instructions.push("ğŸ¯ **åŸºç¤æŒ‡å°åŸå‰‡**ï¼š");
    instructions.push("- å·¥å…·ç‰¹å®šçš„æ ¸å¿ƒåŸå‰‡1");
    instructions.push("- å·¥å…·ç‰¹å®šçš„æ ¸å¿ƒåŸå‰‡2");
    instructions.push("");

    // å®šç¾©å¿…è¦æ¬„ä½
    const requiredFields = ["field1", "field2", "field3"];
    instructions.push("ğŸ“‹ **å¿…è¦æ¬„ä½è¦æ±‚**ï¼š");
    instructions.push(
      `- å¦‚æœç”¨æˆ¶æœªè¡¨æ˜æ¬„ä½ï¼Œå‰‡è‡³å°‘åˆ—å‡º ${requiredFields.join(", ")} æ¬„ä½`
    );
    instructions.push("");

    // æ ¼å¼åŒ–è¦æ±‚
    instructions.push("ğŸ¨ **æ ¼å¼åŒ–è¦æ±‚**ï¼š");
    instructions.push("- å·¥å…·ç‰¹å®šçš„æ ¼å¼åŒ–è¦æ±‚");
    instructions.push("");

    return instructions.join("\n");
  }
}
```

### 2. åœ¨ Service ä¸­ä½¿ç”¨æ··åˆæ¶æ§‹

```javascript
// å°å…¥å°æ‡‰çš„ Tool
import { NewToolName } from "../../tools/path/new-tool.js";

// åœ¨æœå‹™æ–¹æ³•ä¸­
const tool = new NewToolName();
const baseInstructions = tool.getBaseInstructions();

const dynamicInstructions = generateDynamicInstructions(/* æ¥­å‹™é‚è¼¯ */);

const aiInstructions = dynamicInstructions
  ? `${baseInstructions}ğŸ§  **å‹•æ…‹åˆ†ææŒ‡å°**ï¼š\n${dynamicInstructions}`
  : baseInstructions;
```

## ğŸ”® æ“´å±•æ–¹å‘

### çŸ­æœŸå„ªåŒ–

1. **æ¨™æº–åŒ– getBaseInstructions æ–¹æ³•**: åœ¨ BaseTool ä¸­å®šç¾©æ¥å£
2. **å·¥å…·æŒ‡å°é©—è­‰**: è‡ªå‹•æª¢æŸ¥æŒ‡å°æ ¼å¼çš„å®Œæ•´æ€§
3. **æŒ‡å°ç‰ˆæœ¬ç®¡ç†**: ç‚ºæ¯å€‹å·¥å…·çš„æŒ‡å°æ·»åŠ ç‰ˆæœ¬æ¨™è­˜

### é•·æœŸç™¼å±•

1. **æ™ºèƒ½æŒ‡å°æ¨è–¦**: åŸºæ–¼å·¥å…·ä½¿ç”¨æƒ…æ³æ¨è–¦æœ€ä½³æŒ‡å°
2. **A/B æ¸¬è©¦æ”¯æ´**: åœ¨å·¥å…·å±¤æ”¯æ´ä¸åŒæŒ‡å°ç‰ˆæœ¬çš„æ¸¬è©¦
3. **æŒ‡å°æ•ˆæœè¿½è¹¤**: çµ±è¨ˆä¸åŒæŒ‡å°å° AI å›æ‡‰è³ªé‡çš„å½±éŸ¿

## ğŸ“‹ ç›¸é—œæ–‡ä»¶

- **Tool å¯¦æ–½ç¯„ä¾‹**: `sfda_mcpserver/mcp-server/src/tools/mil/get-mil-list.js`
- **Service æ•´åˆç¯„ä¾‹**: `sfda_mcpserver/mcp-server/src/services/mil/mil-service.js`
- **æ¸¬è©¦è…³æœ¬**: `backend/database/scripts/test_tool_based_architecture.js`

## ğŸ‰ ç¸½çµ

åŸºæ–¼ Tool çš„æ··åˆæ¶æ§‹æˆåŠŸå¯¦ç¾äº†ï¼š

âœ… **å°±è¿‘ç®¡ç†**: Tool çš„æŒ‡å°å°±åœ¨ Tool æ–‡ä»¶ä¸­  
âœ… **è·è²¬æ¸…æ™°**: é¿å…å–®ä¸€æ–‡ä»¶æ‰¿æ“”éå¤šè²¬ä»»  
âœ… **ç¨ç«‹æ€§å¼·**: æ¯å€‹å·¥å…·ç®¡ç†è‡ªå·±çš„è¦å‰‡  
âœ… **æ˜“æ–¼ç¶­è­·**: ç›¸é—œé‚è¼¯é›†ä¸­ï¼Œé™ä½è€¦åˆåº¦  
âœ… **æ•¸æ“šé©…å‹•**: ä¿ç•™ Service å±¤çš„æ™ºèƒ½åˆ†æèƒ½åŠ›

é€™å€‹æ¶æ§‹å®Œç¾ç¬¦åˆç”¨æˆ¶çš„æœŸæœ›ï¼Œå¯¦ç¾äº†åŸºç¤æŒ‡å°çš„åˆ†æ•£ç®¡ç†ï¼ŒåŒæ™‚ä¿æŒäº†å‹•æ…‹æŒ‡å°çš„éˆæ´»æ€§ã€‚æ¯å€‹å·¥å…·éƒ½æ˜¯è‡ªå·±æŒ‡å°çš„ä¸»äººï¼Œé¿å…äº†ä»»ä½•å–®é»éè¼‰çš„å•é¡Œã€‚
